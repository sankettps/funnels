<% if @shop.is_products_cloned || @shop.is_products_clonning %>
  <div class="sync_product">
    we are synchronising products...
  </div>
<% end %>

  <div class="row">
    <div class="col-lg-12">
      <div class="panel panel-default">
        <div class="panel-heading clearfix">
          <h4>Funnel List</h4>
          <a href="<%= new_funnel_path %>" class="add_new"><button class="btn btn-default add_new">Add New</button> </a>
        </div>
        <!-- /.panel-heading -->
        <div class="panel-body"> 
          <table width="100%" class="table table-striped table-bordered table-hover funnels-list" id="dataTables-example">
            <thead>
              <tr>
                <th>Funnel Name</th>
                <th>Up Sell Product</th>
                <th>Down Sell Product</th>
                <th>Actions</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <% @funnels.each do |funnel| %>
                <tr>
                  <td><%= funnel.name %></td>
                  <td><%= funnel.up_product.title %></td>
                  <td><%= funnel.down_product.title %></td>
                  <td class="center">
                    <%= link_to '<i class="glyphicon glyphicon-pencil" aria-hidden="true"></i>'.html_safe,edit_funnel_path(funnel.id) %>
                    <%#= link_to '<i class="fa fa-trash-o" aria-hidden="true"></i>'.html_safe,"#" %>
                    <a data-confirm="Are you sure you want to delete?" rel="nofollow" data-method="delete" href="/funnels/<%= funnel.id %>"><i class="glyphicon glyphicon-trash" aria-hidden="true"></i></a>
                  </td>
                  <td class="center">
                    <input type="checkbox" id="fid<%= funnel.id %>" name="set-name" class="switch-input">
                  <label for="fid<%= funnel.id %>" class="switch-label"></label>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
            <!-- /.table-responsive -->
        </div>
        <!-- /.panel-body -->
      </div>
      <!-- /.panel -->
    </div>
      <!-- /.col-lg-12 -->
  </div>
<script type="text/javascript">
  $(document).ready(function() {
      $('#dataTables-example').DataTable({
          responsive: true
      });
    <% if @shop.is_products_cloned || @shop.is_products_clonning %>
      var set_loader = setInterval(function(){
        $.ajax({
          type:'GET',
          url: '/dashboard/product_sync_status',
          success:function(data){
            console.log("inside success-->",data);
            if(data == "synced"){
              console.log("inside if");
              $(".sync_product").html('');
              clearInterval(set_loader);
            }
          }
        })
      },10000);
    <% end %>
    
  });

</script>